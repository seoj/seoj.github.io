!function i(o,r,a){function s(t,e){if(!r[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(u)return u(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=r[t]={exports:{}},o[t][0].call(n.exports,function(e){return s(o[t][1][e]||e)},n,n.exports,i,o,r,a)}return r[t].exports}for(var u="function"==typeof require&&require,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.configurations=void 0;n.configurations={fps:60,grid:{size:32},snake:{startLength:2,startSpeed:2}}},{}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Controller=void 0;var o=e("./configurations"),r=e("./direction");function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=document.querySelector("canvas"),e=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.model=e,this.view=t}var e,t,i;return e=n,(t=[{key:"start",value:function(){var t=this;document.addEventListener("keydown",function(e){t.onKeyDown(e)}),s.addEventListener("touchstart",function(e){t.onTouchStart(e)}),s.addEventListener("touchend",function(e){t.onTouchEnd(e)}),setInterval(function(){t.model.next(),t.view.update()},1e3/o.configurations.fps)}},{key:"onKeyDown",value:function(e){var t=u[e.key];t&&(this.model.direction=t,e.preventDefault())}},{key:"onTouchStart",value:function(e){e.preventDefault(),this.touch=e.touches[0]}},{key:"onTouchEnd",value:function(e){e.preventDefault();var t,n=e.changedTouches[0];this.touch&&(t=n.clientX-this.touch.clientX,e=n.clientY-this.touch.clientY,Math.abs(t)>Math.abs(e)?this.model.direction=t<0?r.Direction.left:r.Direction.right:this.model.direction=e<0?r.Direction.up:r.Direction.down),this.touch=n}}])&&a(e.prototype,t),i&&a(e,i),n}();n.Controller=e;var u={ArrowUp:r.Direction.up,ArrowDown:r.Direction.down,ArrowLeft:r.Direction.left,ArrowRight:r.Direction.right}},{"./configurations":1,"./direction":3}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.opposites=n.offsets=n.Direction=void 0;var i,o=e("./point");function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.Direction=i,(e=i||(n.Direction=i={}))[e.up=1]="up",e[e.down=2]="down",e[e.left=3]="left",e[e.right=4]="right";var e=(r(e={},i.up,new o.Point(0,-1)),r(e,i.down,new o.Point(0,1)),r(e,i.left,new o.Point(-1,0)),r(e,i.right,new o.Point(1,0)),e);n.offsets=e;r(e={},i.up,i.down),r(e,i.down,i.up),r(e,i.left,i.right),r(e,i.right,i.left);n.opposites=e},{"./point":7}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GameState=void 0,n.GameState=void 0,(n=n.GameState={})[n.new=1]="new",n[n.running=2]="running",n[n.over=3]="over"},{}],5:[function(e,t,n){"use strict";var i=e("./controller"),o=e("./model"),e=e("./view"),o=new o.Model,e=new e.View(o);new i.Controller(o,e).start()},{"./controller":2,"./model":6,"./view":9}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Model=void 0;var o=e("./configurations"),r=e("./game_state"),a=e("./point"),s=e("./snake");function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}e=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reset()}var t,n,i;return t=e,(n=[{key:"reset",value:function(){this.gameState=r.GameState.new,this.snake=new s.Snake,this.food=this.createFood(),this.score=0,this.resetGameOverCountdown()}},{key:"resetGameOverCountdown",value:function(){this.gameOverCountdown=3*o.configurations.fps}},{key:"next",value:function(){switch(this.gameState){case r.GameState.new:break;case r.GameState.running:if(this.snake.next(),this.snake.collided()){navigator.vibrate(100),this.gameState=r.GameState.over;break}this.snake.includes(this.food)&&(this.snake.eat(),this.score++,this.food=this.createFood());break;case r.GameState.over:0==this.gameOverCountdown--&&this.reset()}}},{key:"createFood",value:function(){for(;;){var e=new a.Point(c(1,o.configurations.grid.size-1),c(1,o.configurations.grid.size-1));if(!this.snake.includes(e))return e}}},{key:"direction",set:function(e){this.snake.bufferedDirection=e,this.gameState!==r.GameState.running&&(this.gameState=r.GameState.running)}}])&&u(t.prototype,n),i&&u(t,i),e}();function c(e,t){return Math.floor(Math.random()*(t-e)+e)}n.Model=e},{"./configurations":1,"./game_state":4,"./point":7,"./snake":8}],7:[function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(n,"__esModule",{value:!0}),n.Point=void 0;var i=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.x=e,this.y=t}var e,t,i;return e=n,(t=[{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}},{key:"add",value:function(e){return new n(this.x+e.x,this.y+e.y)}}])&&o(e.prototype,t),i&&o(e,i),n}();n.Point=i},{}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Snake=void 0;var o=e("./configurations"),r=e("./direction");function a(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u=new(e("./point").Point)(Math.floor(o.configurations.grid.size/2),Math.floor(o.configurations.grid.size/2)),e=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.length=o.configurations.snake.startLength,this.moveCountdown=0,this.positions=[u],this.speed=o.configurations.snake.startSpeed,this.resetMoveCountdown()}var t,n,i;return t=e,(n=[{key:"next",value:function(){var e;0===this.moveCountdown&&(this.direction!==r.opposites[this.bufferedDirection]&&(this.direction=this.bufferedDirection),e=this.head.add(r.offsets[this.direction]),this.positions=[e].concat(a(this.positions)).slice(0,this.length),this.resetMoveCountdown()),this.moveCountdown--}},{key:"includes",value:function(t){return this.positions.some(function(e){return e.equals(t)})}},{key:"collided",value:function(){if(this.head.x<0||this.head.x>=o.configurations.grid.size||this.head.y<0||this.head.y>=o.configurations.grid.size)return!0;for(var e=1;e<this.positions.length;e++)if(this.positions[0].equals(this.positions[e]))return!0;return!1}},{key:"eat",value:function(){this.length++,this.speed++,navigator.vibrate(100)}},{key:"resetMoveCountdown",value:function(){this.moveCountdown=Math.floor(o.configurations.fps/this.speed)}},{key:"head",get:function(){return this.positions[0]}}])&&s(t.prototype,n),i&&s(t,i),e}();n.Snake=e},{"./configurations":1,"./direction":3,"./point":7}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.View=void 0;var i=e("./configurations"),o=e("./game_state");function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var e=document.querySelector("canvas"),a=document.getElementById("score"),s=e.getContext("2d");e.width=320;var u=(e.height=320)/i.configurations.grid.size,c=Math.floor(160),i=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.model=e}var e,n,i;return e=t,(n=[{key:"update",value:function(){s.fillStyle="#000",s.fillRect(0,0,320,320),a.innerText="Score: ".concat(this.model.score);for(var e=0;e<this.model.snake.positions.length;e++)s.fillStyle=0===e?"#ff0":"#0f0",f(this.model.snake.positions[e]);switch(s.fillStyle="#f00",f(this.model.food),s.fillStyle="#fff",s.textAlign="center",s.textBaseline="middle",this.model.gameState){case o.GameState.new:s.font="64px VT323",s.fillText("Snake!",c,c),s.font="24px VT323",navigator.maxTouchPoints?s.fillText("Swipe to move",c,c+64):s.fillText("Use arrow key to move",c,c+64);break;case o.GameState.over:s.font="24px VT323",s.fillText("GAME OVER",c,c)}}}])&&r(e.prototype,n),i&&r(e,i),t}();function f(e){var t=Math.ceil(u);s.fillRect(Math.floor(e.x*u),Math.floor(e.y*u),t,t)}n.View=i},{"./configurations":1,"./game_state":4}]},{},[5]);
