class Book{constructor(t=0,e="",s=[]){this.ordinal=t,this.name=e,this.chapters=s}}class Chapter{constructor(t=0,e=[]){this.number=t,this.verses=e}}class Verse{constructor(t=0,e=null,s=null,r=0,o=0){this.id=t,this.book=e,this.chapter=s,this.number=r,this.textLength=o}}class DailyPlan{constructor(t=null,e=null,s=null){this.date=new Date(t),this.fromVerse=e,this.toVerse=s}}class IndexCtrl{constructor(t){this.books=[],this.verses=new Map,this.fromBook=null,this.fromChapter=null,this.toBook=null,this.toChapter=null,this.range={},this.fromDate=new Date,this.toDate=new Date(this.fromDate),this.toDate.setMonth(11),this.toDate.setDate(31),this.dailyPlans=[],t.get("verses.json").then(t=>{const e=t.data;let s,r,o=0;for(const t of e){s&&s.name===t.bookName||(s=new Book(t.bookOrdinal,t.bookName),this.books.push(s)),r&&r.number===t.chapterNum||(r=new Chapter(t.chapterNum),s.chapters.push(r));const e=new Verse(o++,s,r,t.verseNum,t.textLength);r.verses.push(e),this.verses.set(e.id,e)}this.fromBook=this.books[0],this.fromChapter=this.fromBook.chapters[0],this.range.fromVerse=this.fromChapter.verses[0],this.toBook=this.books[this.books.length-1],this.toChapter=this.toBook.chapters[this.toBook.chapters.length-1],this.range.toVerse=this.toChapter.verses[this.toChapter.verses.length-1]})}onCreatePlan(){this.dailyPlans=[];const t=this.range.fromVerse,e=this.range.toVerse;let s=getDateRange(this.fromDate,this.toDate),r=0;for(let s=t.id;s<=e.id;s++)r+=this.verses.get(s).textLength;const o=r/s;let n=o,h=null,i=new Date(this.fromDate);for(let s=t.id;s<=e.id;s++){const t=this.verses.get(s);h||(h=t),((n-=t.textLength)<=0||s===e.id)&&(this.dailyPlans.push(new DailyPlan(i,h,t)),n+=o,h=null,incrementDate(i))}}}function getDateRange(t,e){const s=new Date(t);let r=1;for(;r++,incrementDate(s),!(s.getTime()>=e.getTime()););return r}function incrementDate(t){t.setDate(t.getDate()+1)}function verseToString(t){return`${t.book.name} ${t.chapter.number}:${t.number}`}function verseFilter(t){return verseToString(t)}IndexCtrl.$inject=["$http"],angular.module("bible",[]).controller("IndexCtrl",IndexCtrl).filter("verse",()=>verseFilter);
