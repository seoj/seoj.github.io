!function r(i,o,a){function s(t,e){if(!o[t]){if(!i[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(u)return u(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=o[t]={exports:{}},i[t][0].call(n.exports,function(e){return s(i[t][1][e]||e)},n,n.exports,r,i,o,a)}return o[t].exports}for(var u="function"==typeof require&&require,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Alien=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),o=r(e("@babel/runtime/helpers/createClass")),a=e("./bullet"),s=e("./point"),u=e("./rectangle"),l=e("./utils"),e=function(){function t(e){(0,i.default)(this,t),this.game=e,this.rectangle=new u.Rectangle(new s.Point(0,0),16,16),this.vx=0,this.vy=0,this.cooldown=0,this.rectangle.position.x=(0,l.rand)(0,this.game.rectangle.width-this.rectangle.width);e=(0,l.rand)(0,2*Math.PI);this.vx=Math.cos(e),this.vy=Math.sin(e),this.resetCooldown()}return(0,o.default)(t,[{key:"resetCooldown",value:function(){this.cooldown=this.game.msToFrames(500)}},{key:"update",value:function(){var e,t=this.rectangle,n=t.position;0===this.cooldown&&(0,l.rand)(0,1)<.01&&((e=new a.Bullet(this,this.game)).vy=2,e.rectangle.position.x=this.rectangle.center.x-e.rectangle.width/2,e.rectangle.position.y=this.rectangle.center.y-e.rectangle.height,this.game.entities.push(e),this.resetCooldown()),(n.x<0||n.x+t.width>this.game.rectangle.width)&&(this.vx=-this.vx),(n.y<0||n.y+t.height>this.game.rectangle.height)&&(this.vy=-this.vy),n.x+=this.vx,n.y+=this.vy,0<this.cooldown&&this.cooldown--}},{key:"draw",value:function(e){var t=this.rectangle.position;e.drawImage(this.game.assets.alien,t.x,t.y)}},{key:"die",value:function(){this.game.deleteList.push(this)}}]),t}();n.Alien=e},{"./bullet":3,"./point":6,"./rectangle":7,"./utils":9,"@babel/runtime/helpers/classCallCheck":10,"@babel/runtime/helpers/createClass":11,"@babel/runtime/helpers/interopRequireDefault":12}],2:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Assets=void 0;var i=r(e("@babel/runtime/regenerator")),o=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),s=function(e,a,s,u){return new(s=s||Promise)(function(n,t){function r(e){try{o(u.next(e))}catch(e){t(e)}}function i(e){try{o(u.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,i)}o((u=u.apply(e,a||[])).next())})},e=function(){function e(){(0,o.default)(this,e)}return(0,a.default)(e,[{key:"load",value:function(){return s(this,void 0,void 0,i.default.mark(function e(){return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u("assets/images/ship.png");case 2:return this.ship=e.sent,e.next=5,u("assets/images/alien.png");case 5:this.alien=e.sent;case 6:case"end":return e.stop()}},e,this)}))}}]),e}();function u(e){var t=new Image;return t.src=e,new Promise(function(e){t.addEventListener("load",function(){e(t)})})}n.Assets=e},{"@babel/runtime/helpers/classCallCheck":10,"@babel/runtime/helpers/createClass":11,"@babel/runtime/helpers/interopRequireDefault":12,"@babel/runtime/regenerator":13}],3:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Bullet=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),o=r(e("@babel/runtime/helpers/createClass")),a=e("./alien"),s=e("./point"),u=e("./rectangle"),l=e("./ship");function c(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,t=function(){};return{s:t,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw i}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e=function(){function n(e,t){(0,i.default)(this,n),this.source=e,this.game=t,this.rectangle=new u.Rectangle(new s.Point(0,0),2,2),this.vx=0,this.vy=0}return(0,o.default)(n,[{key:"update",value:function(){var e=this.rectangle.position;if(e.x<0||e.x>this.game.rectangle.width||e.y<0||e.y>this.game.rectangle.height)this.remove();else{if(this.source instanceof l.Ship){var t=c(this.game.entities);try{for(t.s();!(n=t.n()).done;){var n=n.value;if(n instanceof a.Alien&&this.rectangle.intersects(n.rectangle))return n.die(),void this.remove()}}catch(e){t.e(e)}finally{t.f()}}if(this.source instanceof a.Alien){var r=c(this.game.entities);try{for(r.s();!(i=r.n()).done;){var i=i.value;if(i instanceof l.Ship&&this.rectangle.intersects(i.rectangle))return i.die(),void this.remove()}}catch(e){r.e(e)}finally{r.f()}}e.x+=this.vx,e.y+=this.vy}}},{key:"remove",value:function(){this.game.deleteList.push(this)}},{key:"draw",value:function(e){e.fillStyle="#fff",e.fillRect(this.rectangle.position.x,this.rectangle.position.y,this.rectangle.width,this.rectangle.height)}}]),n}();n.Bullet=e},{"./alien":1,"./point":6,"./rectangle":7,"./ship":8,"@babel/runtime/helpers/classCallCheck":10,"@babel/runtime/helpers/createClass":11,"@babel/runtime/helpers/interopRequireDefault":12}],4:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Game=void 0;var i=r(e("@babel/runtime/regenerator")),o=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),s=e("./alien"),u=e("./assets"),l=e("./point"),c=e("./rectangle"),h=e("./ship"),f=function(e,a,s,u){return new(s=s||Promise)(function(n,t){function r(e){try{o(u.next(e))}catch(e){t(e)}}function i(e){try{o(u.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,i)}o((u=u.apply(e,a||[])).next())})},e=function(){function e(){(0,o.default)(this,e),this.entities=[],this.deleteList=[],this.assets=new u.Assets,this.fps=60}return(0,a.default)(e,[{key:"reset",value:function(){this.entities=[],this.entities.push(new h.Ship(this));for(var e=0;e<10;e++){var t=new s.Alien(this);this.entities.push(t)}}},{key:"start",value:function(){return f(this,void 0,void 0,i.default.mark(function e(){var t,n=this;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.ctx.canvas,this.rectangle=new c.Rectangle(new l.Point(0,0),t.width,t.height),e.next=4,this.assets.load();case 4:this.reset(),document.addEventListener("keydown",function(t){n.entities.filter(function(e){return e.keydown}).forEach(function(e){return e.keydown(t.key)}),t.preventDefault()}),document.addEventListener("keyup",function(t){n.entities.filter(function(e){return e.keyup}).forEach(function(e){return e.keyup(t.key)}),t.preventDefault()}),t.addEventListener("touchstart",function(t){n.entities.filter(function(e){return e.touchstart}).forEach(function(e){return e.touchstart(t.touches[0])}),t.preventDefault()}),t.addEventListener("touchmove",function(t){n.entities.filter(function(e){return e.touchmove}).forEach(function(e){return e.touchmove(t.touches[0])}),t.preventDefault()}),t.addEventListener("touchend",function(t){n.entities.filter(function(e){return e.touchend}).forEach(function(e){return e.touchend(t.changedTouches[0])}),t.preventDefault()}),setInterval(function(){n.entities.filter(function(e){return e.update}).forEach(function(e){return e.update()}),n.deleteList.forEach(function(t){var e=n.entities.findIndex(function(e){return e===t});0<=e&&n.entities.splice(e,1)}),n.deleteList=[]},1e3/this.fps),this.draw();case 12:case"end":return e.stop()}},e,this)}))}},{key:"msToFrames",value:function(e){return Math.floor(this.fps*e/1e3)}},{key:"draw",value:function(){var t=this;requestAnimationFrame(function(){t.draw()}),this.ctx.imageSmoothingEnabled=!1,this.ctx.fillStyle="#000";var e=this.ctx.canvas;this.ctx.fillRect(0,0,e.width,e.height),this.entities.filter(function(e){return e.draw}).forEach(function(e){return e.draw(t.ctx)})}}]),e}();n.Game=e},{"./alien":1,"./assets":2,"./point":6,"./rectangle":7,"./ship":8,"@babel/runtime/helpers/classCallCheck":10,"@babel/runtime/helpers/createClass":11,"@babel/runtime/helpers/interopRequireDefault":12,"@babel/runtime/regenerator":13}],5:[function(e,t,n){"use strict";e=new(e("./game").Game);e.ctx=document.querySelector("canvas").getContext("2d"),e.start()},{"./game":4}],6:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Point=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),e=function e(t,n){(0,i.default)(this,e),this.x=t,this.y=n};n.Point=e},{"@babel/runtime/helpers/classCallCheck":10,"@babel/runtime/helpers/interopRequireDefault":12}],7:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Rectangle=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),o=r(e("@babel/runtime/helpers/createClass")),a=e("./point"),e=function(){function r(e,t,n){(0,i.default)(this,r),this.position=e,this.width=t,this.height=n}return(0,o.default)(r,[{key:"intersects",value:function(e){return this.position.x<e.position.x+e.width&&this.position.x+this.width>e.position.x&&this.position.y<e.position.y+e.height&&this.position.y+this.height>e.position.y}},{key:"center",get:function(){return new a.Point(this.position.x+this.width/2,this.position.y+this.height/2)}}]),r}();n.Rectangle=e},{"./point":6,"@babel/runtime/helpers/classCallCheck":10,"@babel/runtime/helpers/createClass":11,"@babel/runtime/helpers/interopRequireDefault":12}],8:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Ship=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),o=r(e("@babel/runtime/helpers/createClass")),a=e("./alien"),s=e("./bullet"),u=e("./point"),l=e("./rectangle"),e=function(){function t(e){(0,i.default)(this,t),this.game=e,this.keydownList=new Set,this.cooldown=0;this.rectangle=new l.Rectangle(new u.Point(this.game.rectangle.center.x-8,this.game.rectangle.height-16),16,16)}return(0,o.default)(t,[{key:"resetCooldown",value:function(){this.cooldown=this.game.msToFrames(250)}},{key:"update",value:function(){0===this.game.entities.filter(function(e){return e instanceof a.Alien}).length&&(alert("You win!"),this.game.reset());var e,t,n=this.rectangle.position;this.keydownList.has("w")&&n.y--,this.keydownList.has("s")&&n.y++,this.keydownList.has("a")&&n.x--,this.keydownList.has("d")&&n.x++,this.keydownList.has(",")&&this.fire(),this.touch&&(this.fire(),e=this.touch.pageX-this.touch.target.offsetLeft,t=this.touch.pageY-this.touch.target.offsetTop,e=e-n.x,t=t-n.y,t=Math.atan(t/e),e<0&&(t+=Math.PI),n.x+=Math.cos(t),n.y+=Math.sin(t)),0<this.cooldown&&this.cooldown--}},{key:"fire",value:function(){var e,t,n;0===this.cooldown&&((e=new s.Bullet(this,this.game)).vy=-2,t=e.rectangle.position,n=this.rectangle.center,t.x=n.x-e.rectangle.width/2,t.y=n.y,this.game.entities.push(e),this.resetCooldown())}},{key:"draw",value:function(e){var t=this.rectangle.position;e.drawImage(this.game.assets.ship,t.x,t.y)}},{key:"keydown",value:function(e){this.keydownList.add(e)}},{key:"keyup",value:function(e){this.keydownList.delete(e)}},{key:"touchstart",value:function(e){this.touch=e}},{key:"touchmove",value:function(e){this.touch=e}},{key:"touchend",value:function(){this.touch=null}},{key:"die",value:function(){alert("Game over!"),this.game.reset()}}]),t}();n.Ship=e},{"./alien":1,"./bullet":3,"./point":6,"./rectangle":7,"@babel/runtime/helpers/classCallCheck":10,"@babel/runtime/helpers/createClass":11,"@babel/runtime/helpers/interopRequireDefault":12}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.rand=function(e,t){return Math.random()*(t-e)+e}},{}],10:[function(e,t,n){t.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},{}],11:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}t.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}},{}],12:[function(e,t,n){t.exports=function(e){return e&&e.__esModule?e:{default:e}}},{}],13:[function(e,t,n){t.exports=e("regenerator-runtime")},{"regenerator-runtime":14}],14:[function(e,t,n){var r=function(a){"use strict";var u,e=Object.prototype,l=e.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",n=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var i,o,a,s,t=t&&t.prototype instanceof y?t:y,t=Object.create(t.prototype),r=new E(r||[]);return t._invoke=(i=e,o=n,a=r,s=h,function(e,t){if(s===p)throw new Error("Generator is already running");if(s===d){if("throw"===e)throw t;return P()}for(a.method=e,a.arg=t;;){var n=a.delegate;if(n){var r=function e(t,n){var r=t.iterator[n.method];if(r===u){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=u,e(t,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}r=c(r,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,v;var r=r.arg;if(!r)return n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v;{if(!r.done)return r;n[t.resultName]=r.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=u)}n.delegate=null;return v}(n,a);if(r){if(r===v)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(s===h)throw s=d,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s=p;r=c(i,o,a);if("normal"===r.type){if(s=a.done?d:f,r.arg!==v)return{value:r.arg,done:a.done}}else"throw"===r.type&&(s=d,a.method="throw",a.arg=r.arg)}}),t}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var h="suspendedStart",f="suspendedYield",p="executing",d="completed",v={};function y(){}function g(){}function m(){}var b={};b[r]=function(){return this};t=Object.getPrototypeOf,t=t&&t(t(_([])));t&&t!==e&&l.call(t,r)&&(b=t);var w=m.prototype=y.prototype=Object.create(b);function x(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function k(a,s){var t;this._invoke=function(n,r){function e(){return new s(function(e,t){!function t(e,n,r,i){e=c(a[e],a,n);if("throw"!==e.type){var o=e.arg,n=o.value;return n&&"object"==typeof n&&l.call(n,"__await")?s.resolve(n.__await).then(function(e){t("next",e,r,i)},function(e){t("throw",e,r,i)}):s.resolve(n).then(function(e){o.value=e,r(o)},function(e){return t("throw",e,r,i)})}i(e.arg)}(n,r,e,t)})}return t=t?t.then(e,e):e()}}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function _(t){if(t){var e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,e=function e(){for(;++n<t.length;)if(l.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=u,e.done=!0,e};return e.next=e}}return{next:P}}function P(){return{value:u,done:!0}}return((g.prototype=w.constructor=m).constructor=g).displayName=o(m,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,o(e,i,"GeneratorFunction")),e.prototype=Object.create(w),e},a.awrap=function(e){return{__await:e}},x(k.prototype),k.prototype[n]=function(){return this},a.AsyncIterator=k,a.async=function(e,t,n,r,i){void 0===i&&(i=Promise);var o=new k(s(e,t,n,r),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},x(w),o(w,i,"Generator"),w[r]=function(){return this},w.toString=function(){return"[object Generator]"},a.keys=function(n){var e,r=[];for(e in n)r.push(e);return r.reverse(),function e(){for(;r.length;){var t=r.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=_,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&l.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=u)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function e(e,t){return o.type="throw",o.arg=n,r.next=e,t&&(r.method="next",r.arg=u),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=l.call(i,"catchLoc"),s=l.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&l.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r,i=n.completion;return"throw"===i.type&&(r=i.arg,L(n)),r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:_(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=u),v}},a}("object"==typeof t?t.exports:{});try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},{}]},{},[5]);
